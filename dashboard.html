<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Energy Dashboard</title>
  <meta http-equiv="refresh" content="60">
</head>
<body>
<table border="1">
    {{ range .}}
      <tr>
        <td><b>Location</b></td>
        <td><b>As Of</b></td>
        <td><b>Grid</b></td>
        <td><b>Home</b></td>
        <td><b>Solar</b></td>
        <td><b>Battery</b></td>
        <td><b>Battery Charge</b></td>
        <td><b>Response Time</b></td>
      </tr>
      <tr>
        <td>{{.Location}}</td>
        <td>{{ .AsOf.Format "02 Jan 06 15:04:05 MST" }}</td>
        <td>{{ .SiteInstantPower}}</td>
        <td>{{ .LoadInstantPower}}</td>
        <td>{{ .SolarInstantPower}}</td>
        <td>{{ .BatteryInstantPower}}</td>
        <td>{{ printf "%.2f" .BatteryCharge}}</td>
        <td>{{ .QueryTime}}</td>
      </tr>

      <tr>
        <td><b>Day</b></td>
        <td><b>Batt Hi</b></td>
        <td><b>HighTime</b></td>
        <td><b>Batt Low</b></td>
        <td><b>LowTime</b></td>
        <td><b>Batt Samples</b></td>
        <td><b>Total</b></td>
        <td><b>Batt Avg</b></td>
      </tr>
      {{ range .PctHistory}}
        <tr>
          <td>{{ .DT }}</td>
          <td>{{ printf "%.2f" .HiPct}}</td>
          <td>{{ .HiDT}}</td>
          <td>{{ printf "%.2f" .LowPct}}</td>
          <td>{{ .LowDT}}</td>
          <td>{{ printf "%d" .NumSamples}}</td>
          <td>{{ printf "%.0f" .TotalSamples}}</td>
          <td>{{ printf "%.2f" .AvgPct}}</td>
        </tr>
      {{end}}

      <tr>
        <td><b>Day</b></td>
        <td><b>Samples</b></td>
        <td><b>Site Hi</b></td>
        <td><b>Time</b></td>
        <td><b>Site Low</b></td>
        <td><b>Time</b></td>
        <td><b>Site Imp</b></td>
        <td><b>Site Exp</b></td>
        <td><b>Site Avg</b></td>
        <td><b>Load Hi</b></td>
        <td><b>Time</b></td>
        <td><b>Load Low</b></td>
        <td><b>Time</b></td>
        <td><b>Load Imp</b></td>
        <td><b>Load Exp</b></td>
        <td><b>Load Avg</b></td>
        <td><b>Solar Hi</b></td>
        <td><b>Time</b></td>
        <td><b>Solar Low</b></td>
        <td><b>Time</b></td>
        <td><b>Solar Imp</b></td>
        <td><b>Solar Exp</b></td>
        <td><b>Solar Avg</b></td>
        <td><b>Batt Hi</b></td>
        <td><b>Time</b></td>
        <td><b>Batt Low</b></td>
        <td><b>Time</b></td>
        <td><b>Batt Imp</b></td>
        <td><b>Batt Exp</b></td>
        <td><b>Batt Avg</b></td>
      </tr>
      {{ range .StatsHistory}}
        <tr>
          <td>{{ .DT }}</td>
          <td>{{ printf "%d" .NumBatterySamples }}</td>
          <td>{{ printf "%.0f" .HiSite}}</td>
          <td>{{ .HiSiteDT}}</td>
          <td>{{ printf "%.0f" .LowSite}}</td>
          <td>{{ .LowSiteDT}}</td>
          <td>{{ printf "%.2f" .SiteImported }}</td>
          <td>{{ printf "%.2f" .SiteExported }}</td>
          <td>{{ printf "%.2f" .SiteAvg}}</td>
          <td>{{ printf "%.2f" .HiLoad}}</td>
          <td>{{ .HiLoadDT}}</td>
          <td>{{ printf "%.2f" .LowLoad}}</td>
          <td>{{ .LowLoadDT}}</td>
          <td>{{ printf "%.2f" .LoadImported }}</td>
          <td>{{ printf "%.2f" .LoadExported }}</td>
          <td>{{ printf "%.2f" .LoadAvg}}</td>
          <td>{{ printf "%.0f" .HiSolar}}</td>
          <td>{{ .HiSolarDT}}</td>
          <td>{{ printf "%.0f" .LowSolar}}</td>
          <td>{{ .LowSolarDT}}</td>
          <td>{{ printf "%.2f" .SolarImported }}</td>
          <td>{{ printf "%.2f" .SolarExported }}</td>
          <td>{{ printf "%.2f" .SolarAvg}}</td>
          <td>{{ printf "%.0f" .HiBattery}}</td>
          <td>{{ .HiBatteryDT}}</td>
          <td>{{ printf "%.0f" .LowBattery}}</td>
          <td>{{ .LowBatteryDT}}</td>
          <td>{{ printf "%.2f" .BatteryImported }}</td>
          <td>{{ printf "%.2f" .BatteryExported }}</td>
          <td>{{ printf "%.2f" .BatteryAvg}}</td>
        </tr>
      {{end}}
      <tr></tr>
      <tr></tr>
      <tr></tr>

    {{end}}
</table>

</body>
</html>
